CREATE TABLE #counts
(
    table_name varchar(255),
    row_count int
)

EXEC sp_MSForEachTable @command1='INSERT #counts (table_name, row_count) SELECT ''?'', COUNT(*) FROM ?'
SELECT table_name, row_count FROM #counts ORDER BY table_name, row_count DESC
DROP TABLE #counts

　
　
SELECT [Schema] = s.name
    , [Table] = t.name
    , number = COUNT(*)
FROM sys.columns c
INNER JOIN sys.tables t ON c.object_id = t.object_id
INNER JOIN sys.schemas s ON t.schema_id = s.schema_id
GROUP BY t.name, s.name
having t.name like 'After%'

select * from [dbo].[AUDPackage]
select * from [dbo].[AUDBatchLog]
select * from [dbo].[AUDPackageLog]
select * from [dbo].[sysssislog]
select * from [dbo].[AUDPackageErrorLogID]

select * from [AdventureWorksLT2012_Data].[SalesLT].[Address]
select * from After_Address

-- dashboard view
Create view vwDashboard_Migration
as
select sl.id,sl.event,sl.source,sl.message,
pl.BatchLogID,pl.PackageLogID,pl.ExecutionID,pl.StartDateTime as PkgStart,pl.EndDateTime as PkgEnd,pl.[Status],
p.PackageName,b.[Status] as BatchStatus, b.StartDateTime as BatchStart, b.EndDateTime as BatchEnd
from [dbo].[sysssislog] sl 
join [dbo].[AUDPackageLog] pl
on sl.executionid = pl.ExecutionID
join [dbo].[AUDBatchLog] b
on b.StartDateTime = pl.StartDateTime
join [dbo].[AUDPackage] p
on p.PackageName=sl.source

	

　
　
　
　
　
　
